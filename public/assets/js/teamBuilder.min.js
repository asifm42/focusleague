var FOCUS=window.FOCUS||{};Vue.component("signups",{template:"#signups-template",props:["cycle","gender","count","title","signups","notOnATeam","weekCounts","gendered"],computed:{count:function(){return this.notOnATeam.length},notOnATeam:function(){var a=this.signups;return void 0!==this.gender&&(a=_.filter(this.signups,function(a){return a.gender.toLowerCase()===this.gender?null===a.pivot.team_id:void 0},this)),a},gendered:function(){var a=this.signups;return void 0!==this.gender&&(a=_.filter(this.signups,function(a){return a.gender.toLowerCase()===this.gender},this)),a},weekCounts:function(){for(var a=[],b=0,c=this.cycle.weeks.length;c>b;b++){var d=this.cycle.weeks[b].id,e=0;_.each(this.notOnATeam,function(a){this.isAvailable(a,d)&&e++},this),a.push(e)}return a}},methods:{isAvailable:function(a,b){var c=b,d=_.find(a.availability,function(a){return a.id==c},this);return 1==d.pivot.attending}},events:{teamPlacement:function(a,b){var c=_.findWhere(this.signups,{id:a});c.pivot.team_id=b}},created:function(){}}),Vue.component("signup",{template:"#signup-template",props:["signup","cycle","onATeam","teamOptions","selected"],computed:{onATeam:function(){return null!==this.signup.pivot.team_id},selected:function(){return this.signup.pivot.team_id?this.signup.pivot.team_id:0},teamOptions:function(){var a=[];return _.each(this.cycle.teams,function(b){var c={};c.text=b.name,c.value=b.id,a.push(c)}),a}},methods:{addToTeam:function(a){"select-one"===a.target.type&&(this.signup.pivot.team_id=a.target.value,this.updateTeamOnServer(this.signup))},toggleCaptain:function(a){this.signup.pivot.captain=!this.signup.pivot.captain,this.updateCaptainOnServer(this.signup)},availabilityIconClass:function(a){var b=_.find(this.signup.availability,function(b){return b.id==a.id});return 1==b.pivot.attending?"fa fa-check fa-fw text-success":"fa fa-times fa-fw text-danger"},updateTeamOnServer:function(a){$.ajax({type:"PUT",url:"../../api/cyclesignups/"+a.pivot.id,contentType:"application/json",data:JSON.stringify({team_id:a.pivot.team_id})})},updateCaptainOnServer:function(a){$.ajax({type:"PUT",url:"../../api/cyclesignups/"+a.pivot.id,contentType:"application/json",data:JSON.stringify({captain:a.pivot.captain})})}},created:function(){}}),Vue.component("team",{template:"#team-template",props:["cycle","gender","count","notOnATeam","weekCounts","title","teamId","signups","division"],computed:{players:function(){var a=_.filter(this.signups,function(a){return a.pivot.team_id==this.teamId},this);return a},count:function(){return this.players.length},weekCounts:function(){for(var a=[],b=0,c=this.cycle.weeks.length;c>b;b++){var d=this.cycle.weeks[b].id,e=0;_.each(this.players,function(a){this.isAvailable(a,d)&&e++},this),a.push(e)}return a}},methods:{isAvailable:function(a,b){var c=b,d=_.find(a.availability,function(a){return a.id==c},this);return 1==d.pivot.attending}}});var data={cycle:FOCUS.cycle,signups:FOCUS.cycle.signups};new Vue({el:"#app",data:data,events:{signupAddedToATeam:function(a,b){var c=_.findWhere(this.signups,{id:a});c.pivot.team_id=b,$.ajax({type:"PUT",url:"../../api/cyclesignups/"+c.pivot.id,contentType:"application/json",data:JSON.stringify({team_id:b})})},toggleSignupCaptain:function(a){var b=_.findWhere(this.signups,{id:a});b.pivot.captain=captain,$.ajax({type:"PUT",url:"../../api/cyclesignups/"+b.pivot.id,contentType:"application/json",data:JSON.stringify({captain:1})})}}});